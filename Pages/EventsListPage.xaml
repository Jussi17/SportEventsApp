<?xml version="1.0" encoding="utf-8" ?>
<ContentPage
    x:Class="SportEventsApp.Pages.EventsListPage"
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    xmlns:calendar="clr-namespace:Plugin.Maui.Calendar.Controls;assembly=Plugin.Maui.Calendar"
    Title="Tapahtumat"
    Padding="10">

    <Grid ColumnSpacing="10" RowSpacing="10">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <!--  Tulevat/Menneet  -->
            <RowDefinition Height="*" />
            <!--  Lajit + tapahtumat  -->
        </Grid.RowDefinitions>

        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="350" />
            <!--  Lajit  -->
            <ColumnDefinition Width="*" />
            <!--  Tapahtumat  -->
        </Grid.ColumnDefinitions>

        <!--  Yläreunan napit: Tulevat / Menneet  -->
        <StackLayout
            Grid.Row="0"
            Grid.Column="0"
            Grid.ColumnSpan="2"
            HorizontalOptions="Center"
            Orientation="Horizontal"
            Spacing="20">
            <Button
                x:Name="UpcomingButton"
                BackgroundColor="Blue"
                Clicked="OnUpcomingClicked"
                Text="Tulevat"
                TextColor="White" />
            <Button
                x:Name="PastButton"
                BackgroundColor="LightGray"
                Clicked="OnPastClicked"
                Text="Menneet" />
        </StackLayout>

        <!--  Vasemmalla: Lajilista  -->
        <CollectionView
            x:Name="SportsList"
            Grid.Row="1"
            Grid.Column="0"
            SelectionChanged="OnSportSelected"
            SelectionMode="Single">
            <CollectionView.ItemTemplate>
                <DataTemplate>
                    <Frame
                        Margin="5"
                        Padding="5"
                        BackgroundColor="Blue"
                        BorderColor="DarkBlue"
                        CornerRadius="5"
                        HasShadow="False">
                        <Label
                            FontSize="14"
                            HorizontalOptions="Center"
                            Text="{Binding}"
                            TextColor="White"
                            VerticalOptions="Center" />
                    </Frame>
                </DataTemplate>
            </CollectionView.ItemTemplate>
        </CollectionView>

        <!--  Oikealla: Tapahtumat, 2 rinnakkaista per rivi  -->
        <CollectionView
            x:Name="EventsList"
            Grid.Row="1"
            Grid.Column="1"
            ItemsSource="{Binding FilteredEvents}"
            SelectionMode="None">

            <CollectionView.ItemsLayout>
                <GridItemsLayout
                    HorizontalItemSpacing="10"
                    Orientation="Vertical"
                    Span="2"
                    VerticalItemSpacing="10" />
            </CollectionView.ItemsLayout>

            <CollectionView.ItemTemplate>
                <DataTemplate>
                    <Frame
                        Margin="5"
                        Padding="10"
                        BackgroundColor="{AppThemeBinding Light=White,
                                                          Dark=#333333}"
                        BorderColor="LightGray"
                        CornerRadius="10">

                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="Auto" />
                            </Grid.ColumnDefinitions>

                            <!--  Tapahtuman tiedot  -->
                            <VerticalStackLayout Grid.Column="0">
                                <Label
                                    FontAttributes="Bold"
                                    FontSize="12"
                                    Text="{Binding Sport}"
                                    TextColor="{AppThemeBinding Light=Black,
                                                                Dark=White}" />
                                <Label
                                    FontAttributes="Bold"
                                    FontSize="18"
                                    Text="{Binding Name}"
                                    TextColor="{AppThemeBinding Light=Black,
                                                                Dark=White}" />
                                <Label
                                    FontSize="14"
                                    Text="{Binding Date, StringFormat='⏰ {0:dd.MM.yyyy HH:mm}'}"
                                    TextColor="{AppThemeBinding Light=Gray,
                                                                Dark=LightGray}" />
                                <Label
                                    FontSize="14"
                                    Text="{Binding Location, StringFormat='📍 {0}'}"
                                    TextColor="{AppThemeBinding Light=Black,
                                                                Dark=White}" />
                                <Label
                                    FontSize="14"
                                    Text="{Binding Channel, StringFormat='📺 {0}'}"
                                    TextColor="{AppThemeBinding Light=Gray,
                                                                Dark=LightGray}" />
                            </VerticalStackLayout>

                            <!--  Kellonappi  -->
                            <Button
                                Grid.Column="1"
                                BackgroundColor="Transparent"
                                Clicked="OnClockClicked"
                                HeightRequest="28"
                                HorizontalOptions="End"
                                ImageSource="{Binding BellImage}"
                                IsVisible="{Binding NotifyVisible}"
                                VerticalOptions="Start"
                                WidthRequest="28" />
                        </Grid>
                    </Frame>
                </DataTemplate>
            </CollectionView.ItemTemplate>
        </CollectionView>
    </Grid>
</ContentPage>
